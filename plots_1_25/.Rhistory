color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
# aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.9) +
labs(x = 'CRA near 0, with histogram') +
xlim(-0.001, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
# position = 'identity',
# aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.9) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
# position = 'identity',
# aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
# geom_density(alpha = 0.9) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.9) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
grassl <- dat_summaries %>% filter(geno == 'Grassl')
sum(grassl$cumRelAbund == 0) / nrow(grassl)
?geom_histogram
?aes
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 4) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002) +
ylim(0,500) +
geom_vline(aes(xintercept = 1e-2),
color = 'black',
linetype = 'dashed')
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram')
+
xlim(0, 0.002)
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
sum(grassl$cumRelAbund == 0) / nrow(grassl)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 300) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 1) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 10) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 20) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.00005) +
geom_density(alpha = 0.5, adjust = 20) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
sum(grassl$cumRelAbund == 0) / nrow(grassl)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
sum(grassl$cumRelAbund == 0) / nrow(grassl)
sum(grassl$cumRelAbund > 0.0001) / nrow(grassl)
sum(grassl$cumRelAbund > 0.001) / nrow(grassl)
sum(grassl$cumRelAbund > 0.000001) / nrow(grassl)
sum(grassl$cumRelAbund > 0.000000001) / nrow(grassl)
sum(grassl$cumRelAbund > 0.000000000000001) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 0.0001) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 0.001) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 0.01) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 0.1) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 1) / nrow(grassl)
sum(grassl$cumRelAbund  > 0 && grassl$cumRelAbund < 100) / nrow(grassl)
nrow(filter(grassl, cumRelAbund >0 && cumRelAbund < 0.001)) / nrow(grassl)
nrow(filter(grassl, cumRelAbund >0 && cumRelAbund < 0.01)) / nrow(grassl)
nrow(filter(grassl, cumRelAbund >0 ^ cumRelAbund < 0.01)) / nrow(grassl)
nrow(filter(grassl, cumRelAbund >0 ^^ cumRelAbund < 0.01)) / nrow(grassl)
grassl %>% filter(cumRelAbund > 0)
grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.01)
grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001)
grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001))/nrwo(grassle)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001))/nrwo(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.01))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.01))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001))/nrow(grassl)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund > 0) %>% filter(cumRelAbund < 0.0001))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0, 0.001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.003)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.003)))/nrow(grassl)
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.000001, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, .Machine$double.eps, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.003)))/nrow(grassl)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, .Machine$double.eps, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.0003)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0003, 0.0004)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0004, 0.0005)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, .Machine$double.eps, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.0003)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0003, 0.0004)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0004, 0.0005)))/nrow(grassl)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, .Machine$double.eps, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.0003)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0003, 0.0004)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0004, 0.0005)))/nrow(grassl)
#large bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 30) +
labs(x = 'CRA near 0, large bw') +
xlim(0, 0.002)
#small bandwidth
dat_summaries %>% filter(geno == 'Grassl') %>%
ggplot(aes(x = cumRelAbund, fill = geno)) +
geom_histogram(alpha = 0.9,
position = 'identity',
aes(y = ..density..),
color = 'black',
binwidth = 0.0001) +
geom_density(alpha = 0.5, adjust = 1/2) +
labs(x = 'CRA near 0, with histogram') +
xlim(0, 0.002)
grassl <- dat_summaries %>% filter(geno == 'Grassl')
nrow(grassl %>% filter(cumRelAbund == 0)) / nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, .Machine$double.eps, 0.0001)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0001, 0.0002)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0002, 0.0003)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0003, 0.0004)))/nrow(grassl)
nrow(grassl %>% filter(between(cumRelAbund, 0.0004, 0.0005)))/nrow(grassl)
?density
source('~/Documents/RA Liu/core microbiome/plots_1_25/plots_1_25.R')
getwd("
)
getwd()
setwd("core microbiome/plots_1_25/")
ggsave("b2.pdf")
ggsave("b2.pdf", b2)
ggsave("b1.pdf", b1)
ggsave("t4.pdf", t4)
ggsave("t3.pdf", t3)
ggsave("t2.pdf", t2)
ggsave("t1.pdf", t1)
ggsave("c5.pdf", c5)
ggsave("c4.pdf", c4)
ggsave("c3.pdf", c3)
ggsave("c2.pdf", c2)
ggsave("c1.pdf", c1)
ggsave("bar.pdf", bar)
bar <- ggplot(dat_summaries, aes(x = genoPresence)) +
geom_bar() +
facet_wrap(.~geno) +
labs(x = 'number of samples in which ASV is present', y = 'number of ASVs')
bar
ggsave("bar.pdf", bar)
source('~/Documents/RA Liu/core microbiome/plots_1_25/plots_1_25.R')
